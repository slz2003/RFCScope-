# Expert-Issues Summary (Excluding Router) — Section 5 (Client Behavior)

RFC: Unknown  
Section: Unknown (excerpt covers Section 5.1–5.3 behavior; experts focus on Section 5.1 alias-mode interaction)

This summarizes **all potential bugs raised by the experts** (not the router), deduplicated.

---

## 1) Ambiguity: alias-mode derived endpoint vs “disable fallback” / “switch to SVCB-reliant” for ECH-capable clients

**Concise explanation:**  
Section 5.1 says ECH-capable SVCB-optional clients **MUST switch to SVCB-reliant connection establishment** when SVCB resolution succeeded and **all alternative endpoints** have an `ech` SvcParam (to prevent privacy-negating fallback). But RFC 9460 also says that if **any AliasMode record was processed**, **SVCB-optional clients SHALL append** an extra *alias-derived* endpoint (final `$QNAME`, authority port, **no SvcParams**) to the endpoint list after resolution. It is unclear whether switching to “SVCB-reliant” implies that this alias-derived endpoint must be **suppressed/discarded**, or whether clients may still attempt it (which would be an ECH-less, clear-SNI path).

### Why it’s a potential bug
- RFC 9460 defines “alternative endpoints” as the compatible **ServiceMode** RRs returned by SVCB resolution step 4. The alias-derived endpoint is appended later and is not a ServiceMode RR, so it is not obviously included in “all alternative endpoints have `ech`”.
- A layered implementation could:
  - run a generic SVCB-optional resolver that **already appended** the alias-derived endpoint, then
  - “switch to SVCB-reliant” only by disabling *non-SVCB* fallback,
  - but still attempt the alias-derived endpoint (no `ech`) if ECH-enabled endpoints fail.
- Under active interference (blocking the ECH-enabled ServiceMode endpoints), this could force a downgrade to a non-ECH ClientHello and leak SNI—exactly what Section 5.1 tries to prevent.

### My justification (is it a real bug or a false positive?)
**Borderline: real underspecification risk, but not a hard contradiction.**
- **Scope / Deontic / CrossRFC / Boundary** all treat this as a meaningful **underspecification** because the text does not explicitly say what happens to the alias-derived endpoint in the “switch to SVCB-reliant” case, and two plausible implementations exist with materially different privacy properties.
- **Causal** argues it is **not a protocol-level bug** if specs are read strictly: the alias-derived endpoint is appended only for *SVCB-optional* clients, and once the client “MUST switch to SVCB-reliant,” it should no longer apply optional-only behaviors, so the alias-derived endpoint should not be used. The downgrade path arises mainly if an implementer treats “reliant” as “don’t do non-SVCB fallback” but still uses optional-only alias behaviors.

**My take:** The correct behavior can be inferred by careful reading (as Causal explains), but it is subtle enough that different compliant-looking implementations could diverge. That’s exactly the kind of privacy-sensitive edge case worth an errata/clarification.

### Evidence (from the experts’ cited texts)
- TLS-SVCB-ECH 5.1: ECH-capable SVCB-optional clients MUST switch to SVCB-reliant if resolution succeeded and all alternative endpoints have `ech`.
- RFC 9460 Section 3: alternative endpoints are compatible ServiceMode records; also, if AliasMode processed, SVCB-optional clients SHALL append a final `$QNAME` endpoint with no SvcParams.

### Suggested clarification (minimal fix shape)
Add an explicit sentence to Section 5.1 such as:
- “In this case, clients MUST NOT use the synthesized alias-derived endpoint described in RFC 9460 Section 3, and MUST NOT attempt any endpoint lacking an `ech` SvcParam; only ServiceMode endpoints with `ech` may be attempted.”

---

## Non-issues (experts explicitly found no bug)

### A) Timing rule: “MUST NOT send any TLS ClientHello until after SVCB resolution completes” (Section 5.3)
**Assessment:** Not a bug.  
**Why:** Temporal and Boundary experts say this cleanly refines RFC 9460’s “optimistic pre-connection” rule (you can open transport connections early, but you must not transmit info that SvcParams could change). ECH changes ClientHello contents, so delaying ClientHello is coherent.

**Experts:** Temporal (no issues), Boundary (explicitly “not a bug”).

### B) Terminology mapping: ALPN + SNI apply to the *inner* ClientHello when ECH is used (Section 5.2)
**Assessment:** Not a bug.  
**Why:** Terminology and Temporal experts find the inner/outer ClientHello mapping consistent with RFC 9460’s per-scheme mapping model and ECH semantics.

**Experts:** Terminology (no issues), Temporal (no issues), Boundary (explicitly “not a bug”).

---

# Recap
**Potential bug candidates from experts (deduplicated):**
1. Ambiguous handling of alias-derived endpoint under “disable fallback / switch to SVCB-reliant” for ECH (privacy-relevant underspecification).

**Everything else in this excerpt was assessed as consistent by the experts.**
