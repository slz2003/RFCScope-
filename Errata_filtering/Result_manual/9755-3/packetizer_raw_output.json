{
  "reports": [
    {
      "label": "Ambiguous Timing for Client UTF-8 Quoted-Strings Relative to ENABLE",
      "bug_type": "Underspecification",
      "explanation": "The specification is unclear whether a client may begin sending UTF-8 quoted-strings immediately upon the server advertising the UTF8=ACCEPT capability or only after a successful ENABLE UTF8=ACCEPT command.",
      "justification": [
        "One part of the text requires that a client MUST use the ENABLE command to indicate support for UTF-8 quoted-strings, while another part allows the client to use extended quoted syntax if the server advertises support.",
        "This discrepancy leads to two plausible, incompatible interpretations regarding the effective timing for client-sent UTF-8 quoted-strings."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "A client MUST use the 'ENABLE' command [RFC5161] with the 'UTF8=ACCEPT' option … to indicate to the server that the client accepts UTF-8 in quoted-strings and supports the 'UTF8=ACCEPT' extension."
          },
          {
            "id": "E2",
            "text": "If the server supports 'UTF8=ACCEPT', the client MAY use extended quoted syntax with any IMAP argument that permits a string…"
          }
        ],
        "summary": [
          "(E1) The requirement to use ENABLE implies precondition for sending UTF-8 quoted-strings.",
          "(E2) The allowance based solely on capability advertisement creates ambiguity in the client’s permitted timeline."
        ]
      },
      "fix_direction": "Modify the text to clearly require that clients may only send UTF-8 quoted-strings after successful ENABLE (or explicitly state the intended timeline), in order to resolve the conflict between the MUST and MAY wording.",
      "severity": "Medium",
      "severity_basis": "Inconsistent timing may lead to interoperability failures between clients and servers regarding when UTF-8 quoted strings are allowed.",
      "confidence": "High",
      "experts": [
        "Temporal: T1",
        "ActorDirectionality: Issue-1",
        "Scope: Issue-1",
        "Deontic: Issue-1"
      ],
      "report_id": "9755-3-1"
    },
    {
      "label": "Conflicting APPEND Command Requirements for UTF-8 Headers Pre-ENABLE",
      "bug_type": "Inconsistency",
      "explanation": "The APPEND command section contains contradictory instructions by both accepting UTF-8 headers and mandating rejection of 8‑bit header characters when ENABLE UTF8=ACCEPT has not been issued.",
      "justification": [
        "One sentence states that if the server supports UTF8=ACCEPT, then it accepts UTF-8 headers in the APPEND command message argument.",
        "The immediately following sentence requires that if the client has not issued ENABLE UTF8=ACCEPT, the server MUST reject any APPEND command containing 8‑bit header characters."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "If the server supports 'UTF8=ACCEPT', then the server accepts UTF-8 headers in the 'APPEND' command message argument."
          },
          {
            "id": "E2",
            "text": "If an IMAP server supports 'UTF8=ACCEPT' and the IMAP client has not issued the 'ENABLE UTF8=ACCEPT' command, the server MUST reject, with a 'NO' response, an 'APPEND' command that includes any 8-bit character in message header fields."
          }
        ],
        "summary": [
          "(E1) The text unconditionally permits UTF-8 headers in APPEND commands.",
          "(E2) The text then mandates a rejection of such headers if ENABLE has not been issued, resulting in a direct conflict."
        ]
      },
      "fix_direction": "Revise the APPEND command requirement so that acceptance of UTF-8 headers is explicitly conditioned on the client having successfully issued ENABLE UTF8=ACCEPT.",
      "severity": "Medium",
      "severity_basis": "The contradiction can result in servers or clients behaving inconsistently, leading to potential interoperability issues.",
      "confidence": "High",
      "experts": [
        "Temporal: T2"
      ],
      "report_id": "9755-3-2"
    },
    {
      "label": "Ambiguous Timing for SEARCH Charset Restrictions After ENABLE",
      "bug_type": "Underspecification",
      "explanation": "The specification does not clearly state whether a SEARCH command containing a charset specification violates requirements if it is pipelined with the ENABLE command or sent before the client receives an ENABLED response.",
      "justification": [
        "The text specifies that once a client has enabled UTF-8 support, it MUST NOT issue a SEARCH command with a charset specification.",
        "However, it remains ambiguous whether issuing a pipelined SEARCH immediately after sending ENABLE, but prior to receiving confirmation, constitutes a violation."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Once an IMAP client has enabled UTF-8 support with the 'ENABLE UTF8=ACCEPT' command, it MUST NOT issue a 'SEARCH' command that contains a charset specification."
          },
          {
            "id": "E2",
            "text": "RFC 5161 explicitly allows pipelining ENABLE with other commands, creating ambiguity about when the restriction applies."
          }
        ],
        "summary": [
          "(E1) The SEARCH command is forbidden to include a charset once UTF8=ACCEPT is enabled.",
          "(E2) Pipelining enables the possibility of a SEARCH command being sent before the client receives confirmation, leading to uncertainty."
        ]
      },
      "fix_direction": "Clarify in the specification whether the prohibition applies from the moment the ENABLE command is sent or only after an ENABLED response is received.",
      "severity": "Low",
      "severity_basis": "Although the ambiguity is subtle and likely limited to pipelining scenarios, it may still lead to minor interoperability inconsistencies.",
      "confidence": "High",
      "experts": [
        "Temporal: T3",
        "Boundary: Finding-1"
      ],
      "report_id": "9755-3-3"
    },
    {
      "label": "Underspecified Behavior for NAMESPACE and ACL Under UTF8=ACCEPT",
      "bug_type": "Underspecification",
      "explanation": "While the document claims that UTF8=ACCEPT 'affects' NAMESPACE and ACL, it fails to precisely define the encoding requirements for mailbox names and prefixes in these extensions.",
      "justification": [
        "The text states that the capability also affects other IMAP extensions such as NAMESPACE and ACL but does not detail what encoding rules apply.",
        "This lack of normative guidance may result in some servers providing UTF-8 responses while others continue using legacy modified UTF‑7 for namespace prefixes or ACL mailbox fields."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "This capability also affects other IMAP extensions that can return mailbox names or their prefixes, such as NAMESPACE [RFC2342] and ACL [RFC4314]."
          },
          {
            "id": "E2",
            "text": "Mailbox names MUST comply with the Net-Unicode Definition ([RFC5198], Section 2) with the specific exception that they MUST NOT contain control characters (U+0000 - U+001F and U+0080 - U+009F), a delete character (U+007F), a line separator (U+2028), or a paragraph separator (U+2029)."
          },
          {
            "id": "E3",
            "text": "The text does not spell out what 'affects' concretely means for these syntactic constructs."
          }
        ],
        "summary": [
          "(E1) The capability is said to affect NAMESPACE and ACL, but the exact changes are not detailed.",
          "(E2) The global mailbox name rules are provided, yet no explicit guidance is given for the namespace prefixes or ACL mailbox fields.",
          "(E3) This omission leaves room for divergent implementations."
        ]
      },
      "fix_direction": "Explicitly define the requirements for NAMESPACE prefixes and ACL mailbox arguments, such that these elements must adhere to the same UTF‑8 Net‑Unicode rules as other mailbox names when UTF8=ACCEPT is enabled.",
      "severity": "Medium",
      "severity_basis": "Ambiguity in encoding requirements may cause inconsistent implementations across servers and clients, damaging interoperability.",
      "confidence": "High",
      "experts": [
        "Temporal: T4",
        "ActorDirectionality: NewIssue-1",
        "Scope: Issue-2",
        "Structural: Issue-1",
        "CrossRFC: Issue-1",
        "Boundary: Finding-2"
      ],
      "report_id": "9755-3-4"
    },
    {
      "label": "Unclear Scope of Net‑Unicode Mailbox-Name Requirement Relative to Legacy Representations",
      "bug_type": "Underspecification",
      "explanation": "The document unconditionally mandates that mailbox names comply with the Net‑Unicode Definition without clarifying whether this applies to all on‐wire representations or just to UTF‑8 representations in the UTF8=ACCEPT mode, leading to potential conflicts with legacy modified UTF‑7 usage.",
      "justification": [
        "The text requires 'Mailbox names MUST comply with the Net‑Unicode Definition' but also references legacy conventions from RFC 3501 which use modified UTF‑7.",
        "This creates uncertainty about whether the Net‑Unicode requirement is intended to apply universally or only when a client has fully enabled UTF8=ACCEPT."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Mailbox names MUST comply with the Net‑Unicode Definition ([RFC5198], Section 2) with the specific exception that they MUST NOT contain control characters (U+0000 - U+001F and U+0080 - U+009F), a delete character (U+007F), a line separator (U+2028), or a paragraph separator (U+2029)."
          },
          {
            "id": "E2",
            "text": "RFC 3501 Section 5.1.3 defines the 'Mailbox International Naming Convention' based on modified UTF‑7, and servers 'SHOULD not return 8‑bit mailbox names in LIST or LSUB.'"
          }
        ],
        "summary": [
          "(E1) The strict Net‑Unicode requirement is imposed unconditionally on mailbox names.",
          "(E2) Legacy mailbox naming specifies modified UTF‑7, creating ambiguity over which rule applies in mixed environments."
        ]
      },
      "fix_direction": "Clarify that the Net‑Unicode requirement applies only to mailbox names represented in UTF‑8 under the UTF8=ACCEPT extension while allowing modified UTF‑7 representations for legacy client compatibility, or clearly delineate the transition boundary.",
      "severity": "Medium",
      "severity_basis": "Without clear scoping, implementers may make divergent choices for mailbox name encoding, risking interoperability with legacy systems.",
      "confidence": "High",
      "experts": [
        "Scope: Issue-3"
      ],
      "report_id": "9755-3-5"
    },
    {
      "label": "Incorrect Media Type Name 'message/rfc' Instead of 'message/rfc822'",
      "bug_type": "Inconsistency",
      "explanation": "The text erroneously refers to the media type 'message/rfc' instead of the registered and correct 'message/rfc822', potentially causing confusion.",
      "justification": [
        "The excerpt states that RFC9051 treats message/global like 'message/rfc', yet elsewhere the correct type 'message/rfc822' is used.",
        "Since MIME standards define the registered type as 'message/rfc822', this misnaming is inconsistent."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "[RFC9051], Section 7.5.2 treats message/global like message/rfc, which means that for some messages, the response to FETCH BODYSTRUCTURE varies depending on whether IMAP4rev1 or IMAP4rev2 is in use."
          },
          {
            "id": "E2",
            "text": "When IMAP4rev1 and UTF8=ACCEPT has been enabled, the server MAY treat message/global like message/rfc822 when computing the body structure, but MAY also treat it as described in [RFC3501]."
          }
        ],
        "summary": [
          "(E1) The text incorrectly uses 'message/rfc' in a normative context.",
          "(E2) The presence of 'message/rfc822' elsewhere indicates that 'message/rfc' is a typographical error."
        ]
      },
      "fix_direction": "Change all instances of 'message/rfc' to 'message/rfc822' to align with the proper registered media type.",
      "severity": "Medium",
      "severity_basis": "Incorrect media type naming can lead to confusion in MIME handling and interoperability.",
      "confidence": "High",
      "experts": [
        "Terminology: Issue-1"
      ],
      "report_id": "9755-3-6"
    },
    {
      "label": "Misreferenced Section for 'UTF8=ACCEPT' ENABLE Option Definition",
      "bug_type": "Inconsistency",
      "explanation": "The document incorrectly indicates that the 'UTF8=ACCEPT' option is defined in Section 4, while Section 4 deals only with APPEND command semantics, leading to an internal reference error.",
      "justification": [
        "The text states: 'A client MUST use the ‘ENABLE’ command [RFC5161] with the ‘UTF8=ACCEPT’ option (defined in Section 4 below)...' but Section 4 does not define this option.",
        "This misreferencing may confuse readers about where the capability and its usage are formally specified."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "A client MUST use the 'ENABLE' command [RFC5161] with the 'UTF8=ACCEPT' option (defined in Section 4 below) to indicate to the server that the client accepts UTF-8 in quoted-strings and supports the 'UTF8=ACCEPT' extension."
          },
          {
            "id": "E2",
            "text": "Section 4 in this excerpt is titled 'APPEND Command' and only discusses behavior of APPEND when 'UTF8=ACCEPT' is supported and/or enabled; it does not 'define' the ENABLE option syntax or name."
          }
        ],
        "summary": [
          "(E1) The specification incorrectly refers to Section 4 as containing the definition of the 'UTF8=ACCEPT' option.",
          "(E2) Section 4 is concerned with APPEND command behavior, not the formal definition of the ENABLE option."
        ]
      },
      "fix_direction": "Revise the reference to indicate that the 'UTF8=ACCEPT' capability is defined in Section 3 or remove the erroneous section reference entirely.",
      "severity": "Low",
      "severity_basis": "This is an editorial error that may mislead readers but is unlikely to affect the implementation of the protocol.",
      "confidence": "High",
      "experts": [
        "Terminology: Issue-2"
      ],
      "report_id": "9755-3-7"
    }
  ]
}