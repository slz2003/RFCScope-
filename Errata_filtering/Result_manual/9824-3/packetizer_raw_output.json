{
  "reports": [
    {
      "label": "NXNAME Allowed Location Inconsistency: NSEC vs. NSEC3 Type Bitmaps",
      "bug_type": "Inconsistency",
      "explanation": "The document restricts NXNAME to the NSEC type bitmap in Section 3.5, yet other sections mandate its use in both NSEC and NSEC3 responses, creating a normative inconsistency.",
      "justification": [
        "Section 3.5 states: NXNAME is a Meta-TYPE that SHOULD NOT appear anywhere in a DNS message apart from the NSEC type bitmap of a Compact Answer response for a nonexistent name.",
        "Sections 2 and 4 specify that NXNAME is added to the Type Bit Maps field for responses to nonexistent names – and for NSEC3 the NXNAME is the sole entry – which conflicts with the narrow scope in Section 3.5."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "NXNAME is a Meta-TYPE that SHOULD NOT appear anywhere in a DNS message apart from the NSEC type bitmap of a Compact Answer response for a nonexistent name. (Section 3.5)"
          },
          {
            "id": "E2",
            "text": "This RR type is added to the NSEC Type Bit Maps field for responses to nonexistent names, in addition to the mandated RRSIG and NSEC types. If NSEC3 is being used, this RR type is the sole entry in the Type Bit Maps field. (Section 2)"
          }
        ],
        "summary": [
          "(E1) shows the narrow restriction in Section 3.5, while (E2) shows that NXNAME is also mandated in NSEC3 responses."
        ]
      },
      "fix_direction": "Amend Section 3.5 to clarify that the exception for NXNAME applies to the Type Bit Maps field of both NSEC and NSEC3 resource records in Compact Answer responses.",
      "severity": "Medium",
      "severity_basis": "This inconsistency may lead to divergent implementation interpretations, potentially affecting interoperability.",
      "confidence": "High",
      "experts": [
        "Scope Expert: Issue-1",
        "Deontic Expert: Issue-1",
        "Structural Expert: Issue-1",
        "Terminology Expert: Issue-1",
        "CrossRFC Expert: Issue-3"
      ],
      "report_id": "9824-3-1"
    },
    {
      "label": "NXNAME in NSEC3 Bitmaps Conflicts with RFC 5155's Meta-Type Restrictions",
      "bug_type": "Inconsistency",
      "explanation": "RFC 9824 mandates inclusion of NXNAME in NSEC3 Type Bit Maps, but RFC 5155 requires that bits representing Meta-TYPEs be set to 0, resulting in a direct cross-RFC conflict.",
      "justification": [
        "RFC 5155’s NSEC3 definition states that Bits representing Meta-TYPEs or QTYPEs MUST be set to 0 and ignored if encountered.",
        "RFC 9824, however, instructs that for NSEC3 responses the Type Bit Maps field will contain only the NXNAME Meta-TYPE, creating a normative conflict."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 5155’s NSEC3 definition independently states that in NSEC3 type bit maps, “Bits representing Meta-TYPEs or QTYPEs … MUST be set to 0, since they do not appear in zone data. If encountered, they must be ignored upon reading.” (CrossRFC Expert Issue-1)"
          }
        ],
        "summary": [
          "(E1) highlights the requirement from RFC 5155 that conflicts with the NXNAME inclusion mandated by RFC 9824."
        ]
      },
      "fix_direction": "Either update RFC 5155 to accommodate the NXNAME Meta-TYPE in NSEC3 bit maps or revise RFC 9824 to use an alternative encoding that does not conflict with RFC 5155.",
      "severity": "High",
      "severity_basis": "This is a direct normative conflict between RFCs that can lead to interoperability failures if implementations follow different interpretations.",
      "confidence": "High",
      "experts": [
        "CrossRFC Expert: Issue-1"
      ],
      "report_id": "9824-3-2"
    },
    {
      "label": "Incorrect 'Immediate Lexicographic Successor' Calculation for Next Domain Name",
      "bug_type": "Inconsistency/Underspecification",
      "explanation": "The procedure of adding a leading null label to generate the Next Domain Name is claimed to yield the immediate lexicographic successor, but it instead produces a lexicographically smaller name and omits guidance to ensure that no existing names are covered.",
      "justification": [
        "Section 3.1 claims that the Next Domain Name is obtained by adding a leading label with a single null octet, implying an immediate lexicographic successor, but canonical DNS ordering shows that the created name is a predecessor.",
        "RFC 4470 requires that epsilon functions must not cover any existing names, yet the construction is presented without an accompanying coverage check."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Section 3.1: “The Next Domain Name field SHOULD be set to the immediate lexicographic successor of the QNAME. This is accomplished by adding a leading label with a single null (zero-value) octet. … For example, a request for the nonexistent name 'a.example.com.' would result in … a.example.com. 300 IN NSEC \\000.a.example.com. RRSIG NSEC NXNAME” (Quantitative Expert Issue-1)"
          }
        ],
        "summary": [
          "(E1) illustrates the construction that produces \\000.a.example.com., which is lexicographically less than a.example.com., contradicting its intended immediate successor role."
        ]
      },
      "fix_direction": "Revise the description to remove or qualify the 'immediate lexicographic successor' claim and include explicit instructions to check that the generated [owner, Next) interval does not cover any existing names.",
      "severity": "Medium",
      "severity_basis": "While the degenerate interval does not break DNSSEC validation, misleading instructions may result in non-minimally covering NSEC records.",
      "confidence": "High",
      "experts": [
        "Scope Expert: Issue-2",
        "Quantitative Expert: Issue-1",
        "Causal Expert: Issue-1",
        "CrossRFC Expert: Issue-2",
        "Boundary Expert: Finding-1"
      ],
      "report_id": "9824-3-3"
    },
    {
      "label": "Unsigned-Referral Epsilon Function Lacks 'No Coverage' Check",
      "bug_type": "Underspecification",
      "explanation": "The epsilon function for constructing the Next Domain Name in unsigned referrals, which appends a zero octet to the first label, does not mandate a check to ensure that the resulting NSEC record does not inadvertently cover existing names.",
      "justification": [
        "Section 3.4 describes forming the Next Domain Name by appending a zero octet to the first label, but omits any requirement to check against existing owner names.",
        "RFC 4470’s minimally covering NSEC requirement mandates that the generated interval must not cover any existing names."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "With Compact Denial of Existence, the Next Domain Name field for this NSEC record is computed with a slightly different epsilon function than the immediate lexicographic successor of the owner name… Instead, the Next Domain Name field is formed by appending a zero octet to the first label of the owner name. For example, … sub.example.com. 300 IN NSEC sub\\000.example.com. NS RRSIG NSEC (Structural Expert Issue-2)"
          }
        ],
        "summary": [
          "(E1) demonstrates the unsigned-referral construction without a related check for existing names."
        ]
      },
      "fix_direction": "Amend Section 3.4 to explicitly require that authoritative servers verify no other owner name falls between the constructed Next Domain Name and the owner name.",
      "severity": "Medium",
      "severity_basis": "Omitting this check could cause an NSEC record to falsely assert nonexistence for valid names in the zone.",
      "confidence": "Medium",
      "experts": [
        "Structural Expert: Issue-2"
      ],
      "report_id": "9824-3-4"
    },
    {
      "label": "Lack of Guidance for Epsilon Functions at DNS Name/Label Length Limits",
      "bug_type": "Underspecification",
      "explanation": "The specification does not address how to handle cases where adding a leading null label or appending a null octet may exceed DNS name or label length limits.",
      "justification": [
        "Sections 3.1 and 3.4 provide constructions for generating Next Domain Names without regard for the maximum allowed lengths imposed by DNS standards.",
        "RFC 4470 notes that its epsilon functions do not take into account constraints on the number of labels or total name length, leaving implementation behavior undefined for edge cases."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "RFC 9824 Section 3.1: Next Domain Name for nonexistent names is ‘accomplished by adding a leading label with a single null (zero-value) octet’ to the QNAME. … Section 3.4: for unsigned referrals, the Next Domain Name is formed by ‘appending a zero octet to the first label of the owner name’, e.g., sub.example.com. → sub\\000.example.com. (Boundary Expert Finding-2)"
          }
        ],
        "summary": [
          "(E1) shows the constructions used without any discussion of handling cases where the addition might exceed DNS name or label length limits."
        ]
      },
      "fix_direction": "Provide explicit fallback behavior or additional conditions for selecting an alternative epsilon function when the standard construction would result in an invalid DNS name.",
      "severity": "Medium",
      "severity_basis": "This gap may lead to divergent behavior in extreme cases, affecting robustness and interoperability.",
      "confidence": "High",
      "experts": [
        "Boundary Expert: Finding-2"
      ],
      "report_id": "9824-3-5"
    },
    {
      "label": "Incomplete Normative Guidance for Resolver Behavior on NXNAME Queries",
      "bug_type": "Underspecification",
      "explanation": "While the document mandates that receiving an explicit NXNAME query must result in a FORMERR response and that resolvers must not forward such queries, it does not fully specify the complete expected behavior.",
      "justification": [
        "Section 3.5 states that if an explicit query for the NXNAME RR type is received, the DNS server MUST return a Format Error (FORMERR) and that resolvers MUST NOT forward these queries.",
        "The lack of detailed response instructions leaves room for divergent behaviors among resolver implementations."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "If an explicit query for the NXNAME RR type is received, the DNS server MUST return a Format Error (response code FORMERR). … A resolver MUST NOT forward these queries upstream or attempt iterative resolution. (Deontic Expert Issue-2)"
          }
        ],
        "summary": [
          "(E1) highlights that while a FORMERR response is required, the precise response behavior is not fully normed."
        ]
      },
      "fix_direction": "Clarify the complete expected response behavior for resolvers handling NXNAME queries, including any use of Extended DNS Error codes, to ensure consistency.",
      "severity": "Low",
      "severity_basis": "Although this gap does not impact fundamental DNSSEC validation, inconsistent error signaling may hinder troubleshooting and client expectations.",
      "confidence": "High",
      "experts": [
        "Deontic Expert: Issue-2"
      ],
      "report_id": "9824-3-6"
    },
    {
      "label": "Mismatch in EDNS CO Flag Bit Position Description",
      "bug_type": "Inconsistency",
      "explanation": "There is a discrepancy between the textual description claiming the CO flag occupies the second most significant bit and the IANA table assigning it as ‘Bit 1’, which is the second least significant bit.",
      "justification": [
        "Section 5.1 describes the CO flag as defined in the second most significant bit of the 16‑bit EDNS flags field.",
        "Section 9, Table 2 allocates the CO flag as ‘Bit 1’, leading to confusion about its actual numeric bit position."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Section 5.1: “A new EDNS0 [RFC6891] header flag is defined in the second most significant bit of the flags field in the EDNS0 OPT header. This flag is referred to as the Compact Answers OK (CO) flag.” … Section 9, Table 2: “| Bit 1 | CO   | Compact Answers OK | RFC 9824  |” (Quantitative Expert Issue-2)"
          }
        ],
        "summary": [
          "(E1) evidences the conflict between the descriptive text and the IANA registry assignment for the CO flag."
        ]
      },
      "fix_direction": "Revise the documentation and IANA table to use consistent EDNS flag numbering (with the CO flag in the second most significant bit, e.g. Bit 14 in standard RFC6891 terms) or update both to a consistent alternate numbering.",
      "severity": "Medium",
      "severity_basis": "This inconsistency may lead to incorrect interpretation and handling of the CO flag by different implementations.",
      "confidence": "High",
      "experts": [
        "Quantitative Expert: Issue-2"
      ],
      "report_id": "9824-3-7"
    }
  ]
}