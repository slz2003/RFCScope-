{
  "reports": [
    {
      "label": "Underspecification: Handling of Multiple Deprecation Header Values and Evolving Deprecation Dates",
      "bug_type": "Underspecification",
      "explanation": "The specification defines Deprecation as a singleton Structured Field with a single Date but does not specify how to process multiple header instances or conflicting deprecation dates over time, which may lead to inconsistent interpretations.",
      "justification": [
        "The spec states that 'Deprecation is an Item Structured Header Field; its value MUST be a Date as per Section 3.3.7 of [RFC9651]' but does not explain how to behave if multiple values are present.",
        "It also advises authors to document behavior when multiple members are present, yet RFC 9745 does not clarify if the earliest, latest, or a specific date should be used."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Deprecation is an Item Structured Header Field; its value MUST be a Date as per Section 3.3.7 of [RFC9651]."
          },
          {
            "id": "E2",
            "text": "Authors of fields with a singleton value (see Section 5.5) are additionally advised to document how to treat messages where the multiple members are present (a sensible default would be to ignore the field, but this might not always be the right choice)."
          },
          {
            "id": "E3",
            "text": "9745 does not specify whether a recipient should: (a) reject the header as invalid, (b) pick the earliest date, (c) pick the latest date, or (d) apply some other rule, nor does it say anything about reconciling changing deprecation dates across multiple responses over time."
          }
        ],
        "summary": [
          "(E1) Defines Deprecation as a singleton Date field.",
          "(E2) Advises documenting handling of multiple values but does not specify it.",
          "(E3) Lists the ambiguity in reconciling multiple or evolving deprecation dates."
        ]
      },
      "fix_direction": "Clarify the processing rules for when multiple Deprecation header values are present and specify how conflicting deprecation dates across responses should be handled.",
      "severity": "Low",
      "severity_basis": "Temporal analysis indicates that although ambiguous, the field is advisory and does not affect protocol correctness.",
      "confidence": "High",
      "experts": [
        "TemporalExpert: T1"
      ],
      "report_id": "9745-2-1"
    },
    {
      "label": "Ambiguity in Deprecation Header Resource Scope (Target vs. Representation/Content-Location)",
      "bug_type": "Underspecification",
      "explanation": "The specification is ambiguous about which resource is deprecated, leaving it unclear whether the Deprecation header applies to the target resource that returns the response or to the resource identified via Content-Location.",
      "justification": [
        "RFC 9745 states that the header describes the deprecation of 'the resource identified with the response it occurred within (see Section 6.4.2 of [HTTP])', but Section 6.4.2 defines resource mapping based on content representation which can lead to different interpretations.",
        "The use of non‑standard phrases like 'resource in the context of the message' further deepens the ambiguity when a response includes a Content-Location differing from the request target."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "The Deprecation HTTP response header field describes the deprecation of the resource identified with the response it occurred within (see Section 6.4.2 of [HTTP ])."
          },
          {
            "id": "E2",
            "text": "HTTP 9110 §6.4.2 “Identifying Content” defines rules for mapping a response’s content to a resource, distinguishing: (a) representations of the target resource and (b) representations of a different resource indicated by Content-Location."
          },
          {
            "id": "E3",
            "text": "Ambiguous identification of *which* resource is deprecated (confusing HTTP terminology and scope)"
          },
          {
            "id": "E4",
            "text": "If an implementer reads the specification literally, a response with a differing Content-Location could lead to deprecating either the target resource or the Content-Location resource, resulting in divergent behaviors."
          }
        ],
        "summary": [
          "(E1) Indicates deprecation applies to the 'resource identified with the response'.",
          "(E2) Shows that HTTP §6.4.2 distinguishes between target and Content-Location resources.",
          "(E3) Highlights the ambiguous terminology used in the spec regarding which resource is deprecated.",
          "(E4) Explains the potential for divergent interpretation in edge cases."
        ]
      },
      "fix_direction": "Revise the Deprecation header description to clearly state that it applies to the target resource that returns the response, irrespective of any Content-Location header.",
      "severity": "Medium",
      "severity_basis": "Multiple expert analyses indicate that the ambiguity can lead to inconsistent migration decisions in edge cases.",
      "confidence": "Medium",
      "experts": [
        "ScopeExpert: Issue-1",
        "CausalExpert",
        "CrossRFCExpert: Issue-1",
        "TerminologyExpert: Issue-1",
        "BoundaryExpert: Finding-1"
      ],
      "report_id": "9745-2-2"
    },
    {
      "label": "Invalid Sunset Header Example Timezone ('UTC' instead of 'GMT')",
      "bug_type": "Inconsistency",
      "explanation": "The example provided for the Sunset header in RFC 9745 uses 'UTC' as the timezone, which does not conform to the HTTP-date specification that requires the use of 'GMT'.",
      "justification": [
        "RFC 8594 and the HTTP-date specification mandate that the Sunset header use the IMF-fixdate format with 'GMT' as the timezone.",
        "The example 'Sunset: Sun, 30 Jun 2024 23:59:59 UTC' directly conflicts with the normative example provided in RFC 8594."
      ],
      "evidence": {
        "snippets": [
          {
            "id": "E1",
            "text": "Sunset: Sun, 30 Jun 2024 23:59:59 UTC"
          },
          {
            "id": "E2",
            "text": "For example:  Sunset: Sat, 31 Dec 2018 23:59:59 GMT"
          }
        ],
        "summary": [
          "(E1) Shows the RFC 9745 example using 'UTC' as the timezone.",
          "(E2) Provides the normative example from RFC 8594 using 'GMT'."
        ]
      },
      "fix_direction": "Update the Sunset header example in Section 4 of RFC 9745 to replace 'UTC' with 'GMT' so that it conforms to the HTTP-date syntax.",
      "severity": "Medium",
      "severity_basis": "The inconsistency between the spec example and the normative HTTP-date format may mislead implementers and cause parsing errors.",
      "confidence": "High",
      "experts": [
        "StructuralExpert: Issue-1",
        "CrossRFCExpert: Issue-2"
      ],
      "report_id": "9745-2-3"
    }
  ]
}