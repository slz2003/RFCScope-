
---

## 1) Ambiguity: alias-mode derived endpoint vs “disable fallback” / “switch to SVCB-reliant” for ECH-capable clients

**Concise explanation:**  
Section 5.1 says ECH-capable SVCB-optional clients **MUST switch to SVCB-reliant connection establishment** when SVCB resolution succeeded and **all alternative endpoints** have an `ech` SvcParam (to prevent privacy-negating fallback). But RFC 9460 also says that if **any AliasMode record was processed**, **SVCB-optional clients SHALL append** an extra *alias-derived* endpoint (final `$QNAME`, authority port, **no SvcParams**) to the endpoint list after resolution. It is unclear whether switching to “SVCB-reliant” implies that this alias-derived endpoint must be **suppressed/discarded**, or whether clients may still attempt it (which would be an ECH-less, clear-SNI path).

### Why it’s a potential bug
- RFC 9460 defines “alternative endpoints” as the compatible **ServiceMode** RRs returned by SVCB resolution step 4. The alias-derived endpoint is appended later and is not a ServiceMode RR, so it is not obviously included in “all alternative endpoints have `ech`”.
- A layered implementation could:
  - run a generic SVCB-optional resolver that **already appended** the alias-derived endpoint, then
  - “switch to SVCB-reliant” only by disabling *non-SVCB* fallback,
  - but still attempt the alias-derived endpoint (no `ech`) if ECH-enabled endpoints fail.
- Under active interference (blocking the ECH-enabled ServiceMode endpoints), this could force a downgrade to a non-ECH ClientHello and leak SNI—exactly what Section 5.1 tries to prevent.

### justification 
**Borderline: underspecification**
- **Scope / Deontic / CrossRFC / Boundary** all treat this as a meaningful **underspecification** because the text does not explicitly say what happens to the alias-derived endpoint in the “switch to SVCB-reliant” case, and two plausible implementations exist with materially different privacy properties.
- **Causal** argues it is **not a protocol-level bug** if specs are read strictly: the alias-derived endpoint is appended only for *SVCB-optional* clients, and once the client “MUST switch to SVCB-reliant,” it should no longer apply optional-only behaviors, so the alias-derived endpoint should not be used. The downgrade path arises mainly if an implementer treats “reliant” as “don’t do non-SVCB fallback” but still uses optional-only alias behaviors.


### Evidence (from the experts’ cited texts)
- TLS-SVCB-ECH 5.1: ECH-capable SVCB-optional clients MUST switch to SVCB-reliant if resolution succeeded and all alternative endpoints have `ech`.
- RFC 9460 Section 3: alternative endpoints are compatible ServiceMode records; also, if AliasMode processed, SVCB-optional clients SHALL append a final `$QNAME` endpoint with no SvcParams.

### Suggested clarification (minimal fix shape)
Add an explicit sentence to Section 5.1 such as:
- “In this case, clients MUST NOT use the synthesized alias-derived endpoint described in RFC 9460 Section 3, and MUST NOT attempt any endpoint lacking an `ech` SvcParam; only ServiceMode endpoints with `ech` may be attempted.”

---
